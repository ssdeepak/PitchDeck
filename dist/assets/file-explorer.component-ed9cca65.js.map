{"version":3,"file":"file-explorer.component-ed9cca65.js","sources":["../../src/core/component-system/enhanced-base-component.ts","../../src/core/styling/component-style-manager.ts","../../src/core/styling/styled-component.ts","../../src/components/windows/file-explorer.component.ts"],"sourcesContent":["/**\r\n * Enhanced Component Base Class\r\n * Provides standardized lifecycle, error handling, and performance monitoring\r\n */\r\n\r\nimport type { IComponent } from '../types/index.js';\r\nimport { eventBus } from '../events/event-bus.js';\r\n\r\nexport interface ComponentState {\r\n  isMounted: boolean;\r\n  isDestroyed: boolean;\r\n  hasError: boolean;\r\n  errorMessage?: string;\r\n  mountTime?: number;\r\n  updateCount: number;\r\n}\r\n\r\nexport interface ComponentPerformanceMetrics {\r\n  mountTime: number;\r\n  unmountTime: number;\r\n  updateTimes: number[];\r\n  renderCount: number;\r\n  errorCount: number;\r\n}\r\n\r\nexport interface ComponentError {\r\n  componentId: string;\r\n  error: Error;\r\n  phase: 'mount' | 'unmount' | 'update' | 'render';\r\n  timestamp: Date;\r\n  inputs?: Record<string, unknown> | undefined;\r\n}\r\n\r\n/**\r\n * Enhanced base component with lifecycle management, error boundaries, and performance monitoring\r\n */\r\nexport abstract class EnhancedBaseComponent implements IComponent {\r\n  public readonly container: HTMLElement;\r\n  public inputs?: Record<string, unknown> | undefined;\r\n  \r\n  protected state: ComponentState = {\r\n    isMounted: false,\r\n    isDestroyed: false,\r\n    hasError: false,\r\n    updateCount: 0\r\n  };\r\n  \r\n  protected metrics: ComponentPerformanceMetrics = {\r\n    mountTime: 0,\r\n    unmountTime: 0,\r\n    updateTimes: [],\r\n    renderCount: 0,\r\n    errorCount: 0\r\n  };\r\n\r\n  protected listeners: Array<() => void> = [];\r\n  protected timers: Array<number> = [];\r\n  protected observers: Array<MutationObserver | ResizeObserver | IntersectionObserver> = [];\r\n  protected componentId: string;\r\n\r\n  constructor(container: HTMLElement, inputs?: Record<string, unknown>) {\r\n    this.container = container;\r\n    this.inputs = inputs;\r\n    this.componentId = this.constructor.name;\r\n    \r\n    // Add component identifier to container\r\n    this.container.setAttribute('data-component', this.componentId);\r\n    this.container.setAttribute('data-component-id', this.generateUniqueId());\r\n  }\r\n\r\n  /**\r\n   * Mount the component with error handling and performance monitoring\r\n   */\r\n  async mount(): Promise<void> {\r\n    if (this.state.isMounted || this.state.isDestroyed) {\r\n      return;\r\n    }\r\n\r\n    const startTime = performance.now();\r\n    \r\n    try {\r\n      // Call lifecycle hook\r\n      await this.onBeforeMount();\r\n      \r\n      // Render component\r\n      await this.render();\r\n      \r\n      // Call lifecycle hook\r\n      await this.onMounted();\r\n      \r\n      // Update state\r\n      this.state.isMounted = true;\r\n      this.state.mountTime = performance.now() - startTime;\r\n      this.metrics.mountTime = this.state.mountTime;\r\n      this.metrics.renderCount++;\r\n      \r\n      // Emit mount event\r\n      eventBus.emit('component:mounted', {\r\n        componentId: this.componentId,\r\n        mountTime: this.state.mountTime\r\n      });\r\n      \r\n    } catch (error) {\r\n      await this.handleError(error as Error, 'mount');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Unmount the component with cleanup\r\n   */\r\n  async unmount(): Promise<void> {\r\n    if (!this.state.isMounted || this.state.isDestroyed) {\r\n      return;\r\n    }\r\n\r\n    const startTime = performance.now();\r\n    \r\n    try {\r\n      // Call lifecycle hook\r\n      await this.onBeforeUnmount();\r\n      \r\n      // Cleanup resources\r\n      this.cleanup();\r\n      \r\n      // Call lifecycle hook\r\n      await this.onUnmounted();\r\n      \r\n      // Update state\r\n      this.state.isMounted = false;\r\n      this.state.isDestroyed = true;\r\n      this.metrics.unmountTime = performance.now() - startTime;\r\n      \r\n      // Emit unmount event\r\n      eventBus.emit('component:unmounted', {\r\n        componentId: this.componentId,\r\n        unmountTime: this.metrics.unmountTime\r\n      });\r\n      \r\n    } catch (error) {\r\n      await this.handleError(error as Error, 'unmount');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update component with new inputs\r\n   */\r\n  async update(inputs: Record<string, unknown>): Promise<void> {\r\n    if (!this.state.isMounted || this.state.isDestroyed) {\r\n      return;\r\n    }\r\n\r\n    const startTime = performance.now();\r\n    \r\n    try {\r\n      const previousInputs = this.inputs;\r\n      this.inputs = inputs;\r\n      \r\n      // Check if update is needed\r\n      if (await this.shouldUpdate(previousInputs, inputs)) {\r\n        // Call lifecycle hook\r\n        await this.onBeforeUpdate(previousInputs, inputs);\r\n        \r\n        // Re-render\r\n        await this.render();\r\n        \r\n        // Call lifecycle hook\r\n        await this.onUpdated(previousInputs, inputs);\r\n        \r\n        // Update metrics\r\n        const updateTime = performance.now() - startTime;\r\n        this.state.updateCount++;\r\n        this.metrics.updateTimes.push(updateTime);\r\n        this.metrics.renderCount++;\r\n        \r\n        // Emit update event\r\n        eventBus.emit('component:updated', {\r\n          componentId: this.componentId,\r\n          updateTime,\r\n          updateCount: this.state.updateCount\r\n        });\r\n      }\r\n      \r\n    } catch (error) {\r\n      await this.handleError(error as Error, 'update');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle component errors with recovery\r\n   */\r\n  protected async handleError(error: Error, phase: 'mount' | 'unmount' | 'update' | 'render'): Promise<void> {\r\n    this.state.hasError = true;\r\n    this.state.errorMessage = error.message;\r\n    this.metrics.errorCount++;\r\n    \r\n    const componentError: ComponentError = {\r\n      componentId: this.componentId,\r\n      error,\r\n      phase,\r\n      timestamp: new Date(),\r\n      inputs: this.inputs\r\n    };\r\n    \r\n    // Emit error event\r\n    eventBus.emit('component:error', componentError);\r\n    \r\n    // Try to render error state\r\n    try {\r\n      await this.renderError(error);\r\n    } catch (renderError) {\r\n      // Fallback to basic error display\r\n      this.container.innerHTML = `\r\n        <div class=\"component-error\">\r\n          <h3>Component Error</h3>\r\n          <p>Component ${this.componentId} encountered an error</p>\r\n          <details>\r\n            <summary>Error Details</summary>\r\n            <pre>${error.message}</pre>\r\n          </details>\r\n        </div>\r\n      `;\r\n    }\r\n    \r\n    // Call error recovery hook\r\n    await this.onError(error, phase);\r\n  }\r\n\r\n  /**\r\n   * Cleanup resources\r\n   */\r\n  protected cleanup(): void {\r\n    // Remove event listeners\r\n    this.listeners.forEach(remove => remove());\r\n    this.listeners.length = 0;\r\n    \r\n    // Clear timers\r\n    this.timers.forEach(timer => clearTimeout(timer));\r\n    this.timers.length = 0;\r\n    \r\n    // Disconnect observers\r\n    this.observers.forEach(observer => observer.disconnect());\r\n    this.observers.length = 0;\r\n    \r\n    // Clear container\r\n    this.container.innerHTML = '';\r\n  }\r\n\r\n  /**\r\n   * Add event listener with automatic cleanup\r\n   */\r\n  protected addEventListener<K extends keyof HTMLElementEventMap>(\r\n    element: HTMLElement,\r\n    type: K,\r\n    listener: (this: HTMLElement, ev: HTMLElementEventMap[K]) => void,\r\n    options?: boolean | AddEventListenerOptions\r\n  ): void {\r\n    element.addEventListener(type, listener, options);\r\n    this.listeners.push(() => element.removeEventListener(type, listener, options));\r\n  }\r\n\r\n  /**\r\n   * Add timer with automatic cleanup\r\n   */\r\n  protected setTimeout(callback: () => void, delay: number): number {\r\n    const timer = window.setTimeout(callback, delay);\r\n    this.timers.push(timer);\r\n    return timer;\r\n  }\r\n\r\n  /**\r\n   * Add observer with automatic cleanup\r\n   */\r\n  protected addObserver(observer: MutationObserver | ResizeObserver | IntersectionObserver): void {\r\n    this.observers.push(observer);\r\n  }\r\n\r\n  /**\r\n   * Generate unique component instance ID\r\n   */\r\n  protected generateUniqueId(): string {\r\n    return `${this.componentId}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  /**\r\n   * Get component performance metrics\r\n   */\r\n  public getMetrics(): ComponentPerformanceMetrics {\r\n    return { ...this.metrics };\r\n  }\r\n\r\n  /**\r\n   * Get component state\r\n   */\r\n  public getState(): ComponentState {\r\n    return { ...this.state };\r\n  }\r\n\r\n  // Lifecycle hooks (to be implemented by subclasses)\r\n  protected async onBeforeMount(): Promise<void> {}\r\n  protected async onMounted(): Promise<void> {}\r\n  protected async onBeforeUpdate(previousInputs?: Record<string, unknown>, newInputs?: Record<string, unknown>): Promise<void> {}\r\n  protected async onUpdated(previousInputs?: Record<string, unknown>, newInputs?: Record<string, unknown>): Promise<void> {}\r\n  protected async onBeforeUnmount(): Promise<void> {}\r\n  protected async onUnmounted(): Promise<void> {}\r\n  protected async onError(error: Error, phase: string): Promise<void> {}\r\n\r\n  // Abstract methods (to be implemented by subclasses)\r\n  protected abstract render(): Promise<void>;\r\n  protected async renderError(error: Error): Promise<void> {\r\n    // Default error rendering - can be overridden\r\n    this.container.innerHTML = `\r\n      <div class=\"component-error\">\r\n        <p>Error in ${this.componentId}: ${error.message}</p>\r\n      </div>\r\n    `;\r\n  }\r\n  \r\n  protected async shouldUpdate(previousInputs?: Record<string, unknown>, newInputs?: Record<string, unknown>): Promise<boolean> {\r\n    // Default implementation - shallow comparison\r\n    if (!previousInputs && !newInputs) return false;\r\n    if (!previousInputs || !newInputs) return true;\r\n    \r\n    const prevKeys = Object.keys(previousInputs);\r\n    const newKeys = Object.keys(newInputs);\r\n    \r\n    if (prevKeys.length !== newKeys.length) return true;\r\n    \r\n    return prevKeys.some(key => previousInputs[key] !== newInputs[key]);\r\n  }\r\n}","/**\r\n * Component Style Manager\r\n * Provides scoped CSS system for component isolation and better maintainability\r\n */\r\n\r\nexport interface StyleDefinition {\r\n  selector: string;\r\n  properties: Record<string, string | number>;\r\n}\r\n\r\nexport interface ComponentStyles {\r\n  componentId: string;\r\n  styles: StyleDefinition[];\r\n  globals?: StyleDefinition[];\r\n  variables?: Record<string, string>;\r\n}\r\n\r\nexport interface StylesOptions {\r\n  scoped?: boolean;\r\n  namespace?: string;\r\n  minify?: boolean;\r\n  autoprefixer?: boolean;\r\n}\r\n\r\n/**\r\n * CSS-in-JS Style Manager for Components\r\n */\r\nexport class ComponentStyleManager {\r\n  private static instance: ComponentStyleManager;\r\n  private styleSheets = new Map<string, HTMLStyleElement>();\r\n  private scopedStyles = new Map<string, ComponentStyles>();\r\n  private cssVariables = new Map<string, Record<string, string>>();\r\n  \r\n  private constructor() {}\r\n  \r\n  static getInstance(): ComponentStyleManager {\r\n    if (!ComponentStyleManager.instance) {\r\n      ComponentStyleManager.instance = new ComponentStyleManager();\r\n    }\r\n    return ComponentStyleManager.instance;\r\n  }\r\n\r\n  /**\r\n   * Register component styles\r\n   */\r\n  registerComponentStyles(\r\n    componentId: string,\r\n    styles: ComponentStyles,\r\n    options: StylesOptions = {}\r\n  ): string {\r\n    const {\r\n      scoped = true,\r\n      namespace = componentId,\r\n      minify = false\r\n    } = options;\r\n\r\n    // Generate unique scope identifier\r\n    const scopeId = this.generateScopeId(componentId);\r\n    \r\n    // Process styles with scoping\r\n    const processedCSS = this.processStyles(styles, scopeId, scoped, namespace);\r\n    \r\n    // Create or update style element\r\n    this.createStyleElement(componentId, processedCSS, minify);\r\n    \r\n    // Store styles for hot reloading\r\n    this.scopedStyles.set(componentId, styles);\r\n    \r\n    // Store CSS variables\r\n    if (styles.variables) {\r\n      this.cssVariables.set(componentId, styles.variables);\r\n      this.applyVariables(componentId, styles.variables);\r\n    }\r\n    \r\n    return scopeId;\r\n  }\r\n\r\n  /**\r\n   * Create styles using template literals (CSS-in-JS syntax)\r\n   */\r\n  css(\r\n    template: TemplateStringsArray,\r\n    ...values: (string | number)[]\r\n  ): string {\r\n    let result = template[0] || '';\r\n    \r\n    for (let i = 0; i < values.length; i++) {\r\n      result += String(values[i]) + (template[i + 1] || '');\r\n    }\r\n    \r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Create styled component with automatic scoping\r\n   */\r\n  styled(\r\n    componentId: string,\r\n    styles: string,\r\n    options: StylesOptions = {}\r\n  ): {\r\n    scopeId: string;\r\n    className: (name: string) => string;\r\n  } {\r\n    const scopeId = this.generateScopeId(componentId);\r\n    \r\n    // Parse CSS string into style definitions\r\n    const parsedStyles = this.parseCSS(styles);\r\n    \r\n    const componentStyles: ComponentStyles = {\r\n      componentId,\r\n      styles: parsedStyles\r\n    };\r\n    \r\n    this.registerComponentStyles(componentId, componentStyles, options);\r\n    \r\n    return {\r\n      scopeId,\r\n      className: (name: string) => this.getScopedClassName(name, scopeId)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate scoped class name\r\n   */\r\n  getScopedClassName(className: string, scopeId: string): string {\r\n    return `${className}_${scopeId}`;\r\n  }\r\n\r\n  /**\r\n   * Apply theme variables to a component\r\n   */\r\n  applyTheme(componentId: string, themeVariables: Record<string, string>): void {\r\n    const existingVariables = this.cssVariables.get(componentId) || {};\r\n    const mergedVariables = { ...existingVariables, ...themeVariables };\r\n    \r\n    this.cssVariables.set(componentId, mergedVariables);\r\n    this.applyVariables(componentId, mergedVariables);\r\n  }\r\n\r\n  /**\r\n   * Remove component styles\r\n   */\r\n  removeComponentStyles(componentId: string): void {\r\n    const styleElement = this.styleSheets.get(componentId);\r\n    if (styleElement && styleElement.parentNode) {\r\n      styleElement.parentNode.removeChild(styleElement);\r\n    }\r\n    \r\n    this.styleSheets.delete(componentId);\r\n    this.scopedStyles.delete(componentId);\r\n    this.cssVariables.delete(componentId);\r\n  }\r\n\r\n  /**\r\n   * Hot reload component styles\r\n   */\r\n  hotReloadStyles(componentId: string, newStyles: ComponentStyles): void {\r\n    const scopeId = this.generateScopeId(componentId);\r\n    const processedCSS = this.processStyles(newStyles, scopeId, true, componentId);\r\n    \r\n    const styleElement = this.styleSheets.get(componentId);\r\n    if (styleElement) {\r\n      styleElement.textContent = processedCSS;\r\n    }\r\n    \r\n    this.scopedStyles.set(componentId, newStyles);\r\n  }\r\n\r\n  /**\r\n   * Get all registered component styles\r\n   */\r\n  getAllStyles(): Map<string, ComponentStyles> {\r\n    return new Map(this.scopedStyles);\r\n  }\r\n\r\n  /**\r\n   * Generate unique scope identifier\r\n   */\r\n  private generateScopeId(componentId: string): string {\r\n    // Generate hash-like identifier for scoping\r\n    let hash = 0;\r\n    for (let i = 0; i < componentId.length; i++) {\r\n      const char = componentId.charCodeAt(i);\r\n      hash = ((hash << 5) - hash) + char;\r\n      hash = hash & hash; // Convert to 32-bit integer\r\n    }\r\n    return Math.abs(hash).toString(36).substring(0, 6);\r\n  }\r\n\r\n  /**\r\n   * Process styles with scoping and namespacing\r\n   */\r\n  private processStyles(\r\n    styles: ComponentStyles,\r\n    scopeId: string,\r\n    scoped: boolean,\r\n    namespace: string\r\n  ): string {\r\n    let css = '';\r\n    \r\n    // Add CSS variables\r\n    if (styles.variables) {\r\n      css += this.generateVariablesCSS(styles.variables, scopeId);\r\n    }\r\n    \r\n    // Process component styles\r\n    for (const style of styles.styles) {\r\n      const selector = scoped \r\n        ? this.scopeSelector(style.selector, scopeId)\r\n        : style.selector;\r\n      \r\n      css += this.generateRule(selector, style.properties);\r\n    }\r\n    \r\n    // Process global styles (not scoped)\r\n    if (styles.globals) {\r\n      for (const globalStyle of styles.globals) {\r\n        css += this.generateRule(globalStyle.selector, globalStyle.properties);\r\n      }\r\n    }\r\n    \r\n    return css;\r\n  }\r\n\r\n  /**\r\n   * Scope CSS selector\r\n   */\r\n  private scopeSelector(selector: string, scopeId: string): string {\r\n    // Handle various selector types\r\n    if (selector.startsWith('@')) {\r\n      // Media queries, keyframes, etc.\r\n      return selector;\r\n    }\r\n    \r\n    if (selector.includes(',')) {\r\n      // Multiple selectors\r\n      return selector\r\n        .split(',')\r\n        .map(s => this.scopeSingleSelector(s.trim(), scopeId))\r\n        .join(', ');\r\n    }\r\n    \r\n    return this.scopeSingleSelector(selector, scopeId);\r\n  }\r\n\r\n  /**\r\n   * Scope a single selector\r\n   */\r\n  private scopeSingleSelector(selector: string, scopeId: string): string {\r\n    // Component root selector\r\n    if (selector === ':host' || selector === '&') {\r\n      return `[data-component-scope=\"${scopeId}\"]`;\r\n    }\r\n    \r\n    // Child selectors\r\n    if (selector.startsWith('.') || selector.startsWith('#') || /^[a-zA-Z]/.test(selector)) {\r\n      return `[data-component-scope=\"${scopeId}\"] ${selector}`;\r\n    }\r\n    \r\n    // Pseudo selectors\r\n    if (selector.startsWith(':')) {\r\n      return `[data-component-scope=\"${scopeId}\"]${selector}`;\r\n    }\r\n    \r\n    return selector;\r\n  }\r\n\r\n  /**\r\n   * Generate CSS rule\r\n   */\r\n  private generateRule(selector: string, properties: Record<string, string | number>): string {\r\n    const props = Object.entries(properties)\r\n      .map(([key, value]) => `  ${this.kebabCase(key)}: ${value};`)\r\n      .join('\\n');\r\n    \r\n    return `${selector} {\\n${props}\\n}\\n\\n`;\r\n  }\r\n\r\n  /**\r\n   * Generate CSS variables rule\r\n   */\r\n  private generateVariablesCSS(variables: Record<string, string>, scopeId: string): string {\r\n    const props = Object.entries(variables)\r\n      .map(([key, value]) => `  --${key}: ${value};`)\r\n      .join('\\n');\r\n    \r\n    return `[data-component-scope=\"${scopeId}\"] {\\n${props}\\n}\\n\\n`;\r\n  }\r\n\r\n  /**\r\n   * Create or update style element\r\n   */\r\n  private createStyleElement(componentId: string, css: string, minify: boolean): void {\r\n    let styleElement = this.styleSheets.get(componentId);\r\n    \r\n    if (!styleElement) {\r\n      styleElement = document.createElement('style');\r\n      styleElement.setAttribute('data-component-styles', componentId);\r\n      document.head.appendChild(styleElement);\r\n      this.styleSheets.set(componentId, styleElement);\r\n    }\r\n    \r\n    styleElement.textContent = minify ? this.minifyCSS(css) : css;\r\n  }\r\n\r\n  /**\r\n   * Apply CSS variables to component\r\n   */\r\n  private applyVariables(componentId: string, variables: Record<string, string>): void {\r\n    // Variables are already included in the CSS, but we can also apply them dynamically\r\n    const elements = document.querySelectorAll(`[data-component-scope=\"${this.generateScopeId(componentId)}\"]`);\r\n    \r\n    elements.forEach(element => {\r\n      const htmlElement = element as HTMLElement;\r\n      Object.entries(variables).forEach(([key, value]) => {\r\n        htmlElement.style.setProperty(`--${key}`, value);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Parse CSS string into style definitions\r\n   */\r\n  private parseCSS(css: string): StyleDefinition[] {\r\n    const styles: StyleDefinition[] = [];\r\n    \r\n    // Simple CSS parser (for basic CSS-in-JS support)\r\n    const rules = css.match(/([^{}]+)\\{([^{}]+)\\}/g) || [];\r\n    \r\n    rules.forEach(rule => {\r\n      const [, selector, properties] = rule.match(/([^{}]+)\\{([^{}]+)\\}/) || [];\r\n      if (selector && properties) {\r\n        const props: Record<string, string> = {};\r\n        \r\n        properties.split(';').forEach(prop => {\r\n          const [key, value] = prop.split(':').map(s => s.trim());\r\n          if (key && value) {\r\n            props[this.camelCase(key)] = value;\r\n          }\r\n        });\r\n        \r\n        styles.push({\r\n          selector: selector.trim(),\r\n          properties: props\r\n        });\r\n      }\r\n    });\r\n    \r\n    return styles;\r\n  }\r\n\r\n  /**\r\n   * Convert camelCase to kebab-case\r\n   */\r\n  private kebabCase(str: string): string {\r\n    return str.replace(/[A-Z]/g, match => `-${match.toLowerCase()}`);\r\n  }\r\n\r\n  /**\r\n   * Convert kebab-case to camelCase\r\n   */\r\n  private camelCase(str: string): string {\r\n    return str.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\r\n  }\r\n\r\n  /**\r\n   * Minify CSS (basic implementation)\r\n   */\r\n  private minifyCSS(css: string): string {\r\n    return css\r\n      .replace(/\\s+/g, ' ')\r\n      .replace(/;\\s*}/g, '}')\r\n      .replace(/\\s*{\\s*/g, '{')\r\n      .replace(/\\s*}\\s*/g, '}')\r\n      .replace(/\\s*,\\s*/g, ',')\r\n      .replace(/\\s*;\\s*/g, ';')\r\n      .trim();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const styleManager = ComponentStyleManager.getInstance();\r\n\r\n/**\r\n * Utility function for creating component styles\r\n */\r\nexport function createComponentStyles(\r\n  componentId: string,\r\n  stylesFn: () => ComponentStyles,\r\n  options?: StylesOptions\r\n): string {\r\n  const styles = stylesFn();\r\n  return styleManager.registerComponentStyles(componentId, styles, options);\r\n}\r\n\r\n/**\r\n * CSS template literal function\r\n */\r\nexport function css(template: TemplateStringsArray, ...values: (string | number)[]): string {\r\n  return styleManager.css(template, ...values);\r\n}","/**\r\n * Enhanced Base Component with Styling Support\r\n * Extends the base component with integrated styling capabilities\r\n */\r\n\r\nimport { EnhancedBaseComponent } from '../component-system/enhanced-base-component.js';\r\nimport { styleManager, type ComponentStyles, type StylesOptions } from '../styling/component-style-manager.js';\r\n\r\n/**\r\n * Styled Component Base Class\r\n * Provides integrated styling capabilities with scoped CSS\r\n */\r\nexport abstract class StyledComponent extends EnhancedBaseComponent {\r\n  protected scopeId?: string;\r\n  protected styleOptions: StylesOptions;\r\n\r\n  constructor(container: HTMLElement, inputs?: Record<string, unknown>, styleOptions: StylesOptions = {}) {\r\n    super(container, inputs);\r\n    this.styleOptions = { scoped: true, ...styleOptions };\r\n  }\r\n\r\n  /**\r\n   * Register component styles\r\n   */\r\n  protected registerStyles(styles: ComponentStyles): string {\r\n    this.scopeId = styleManager.registerComponentStyles(\r\n      this.componentId,\r\n      styles,\r\n      this.styleOptions\r\n    );\r\n    \r\n    // Add scope attribute to container\r\n    this.container.setAttribute('data-component-scope', this.scopeId);\r\n    \r\n    return this.scopeId;\r\n  }\r\n\r\n  /**\r\n   * Create scoped class name\r\n   */\r\n  protected className(name: string): string {\r\n    if (!this.scopeId) {\r\n      console.warn(`Component ${this.componentId} has no scope ID. Did you forget to call registerStyles()?`);\r\n      return name;\r\n    }\r\n    return styleManager.getScopedClassName(name, this.scopeId);\r\n  }\r\n\r\n  /**\r\n   * Apply theme variables\r\n   */\r\n  protected applyTheme(themeVariables: Record<string, string>): void {\r\n    styleManager.applyTheme(this.componentId, themeVariables);\r\n  }\r\n\r\n  /**\r\n   * Hot reload styles (for development)\r\n   */\r\n  protected hotReloadStyles(newStyles: ComponentStyles): void {\r\n    if (this.scopeId) {\r\n      styleManager.hotReloadStyles(this.componentId, newStyles);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleanup - remove styles when component is destroyed\r\n   */\r\n  protected override cleanup(): void {\r\n    super.cleanup();\r\n    \r\n    // Remove component styles\r\n    styleManager.removeComponentStyles(this.componentId);\r\n  }\r\n\r\n  /**\r\n   * Get styles for this component (to be implemented by subclasses)\r\n   */\r\n  protected abstract getStyles(): ComponentStyles;\r\n\r\n  /**\r\n   * Initialize styles before mounting\r\n   */\r\n  protected override async onBeforeMount(): Promise<void> {\r\n    // Register styles before mounting\r\n    const styles = this.getStyles();\r\n    this.registerStyles(styles);\r\n    \r\n    await super.onBeforeMount();\r\n  }\r\n}\r\n\r\n/**\r\n * Utility function to create styled component styles\r\n */\r\nexport function createStyles(\r\n  styles: Omit<ComponentStyles, 'componentId'>,\r\n  componentId?: string\r\n): ComponentStyles {\r\n  return {\r\n    componentId: componentId || 'unknown',\r\n    ...styles\r\n  };\r\n}\r\n\r\n/**\r\n * CSS template literal with TypeScript support\r\n */\r\nexport function css(template: TemplateStringsArray, ...values: (string | number)[]): string {\r\n  return styleManager.css(template, ...values);\r\n}\r\n\r\n/**\r\n * Responsive breakpoints helper\r\n */\r\nexport const breakpoints = {\r\n  mobile: '(max-width: 768px)',\r\n  tablet: '(max-width: 1024px)',\r\n  desktop: '(min-width: 1025px)',\r\n  largeDesktop: '(min-width: 1440px)'\r\n};\r\n\r\n/**\r\n * Common color palette\r\n */\r\nexport const colors = {\r\n  primary: 'var(--color-primary, #007AFF)',\r\n  secondary: 'var(--color-secondary, #5856D6)',\r\n  success: 'var(--color-success, #34C759)',\r\n  warning: 'var(--color-warning, #FF9500)',\r\n  error: 'var(--color-error, #FF3B30)',\r\n  background: 'var(--color-background, #FFFFFF)',\r\n  surface: 'var(--color-surface, #F2F2F7)',\r\n  text: 'var(--color-text, #000000)',\r\n  textSecondary: 'var(--color-text-secondary, #8E8E93)'\r\n};\r\n\r\n/**\r\n * Common spacing scale\r\n */\r\nexport const spacing = {\r\n  xs: 'var(--spacing-xs, 4px)',\r\n  sm: 'var(--spacing-sm, 8px)',\r\n  md: 'var(--spacing-md, 16px)',\r\n  lg: 'var(--spacing-lg, 24px)',\r\n  xl: 'var(--spacing-xl, 32px)',\r\n  xxl: 'var(--spacing-xxl, 48px)'\r\n};\r\n\r\n/**\r\n * Common typography scale\r\n */\r\nexport const typography = {\r\n  fontFamily: 'var(--font-family, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif)',\r\n  fontSize: {\r\n    xs: 'var(--font-size-xs, 12px)',\r\n    sm: 'var(--font-size-sm, 14px)',\r\n    md: 'var(--font-size-md, 16px)',\r\n    lg: 'var(--font-size-lg, 18px)',\r\n    xl: 'var(--font-size-xl, 24px)',\r\n    xxl: 'var(--font-size-xxl, 32px)'\r\n  },\r\n  fontWeight: {\r\n    normal: 'var(--font-weight-normal, 400)',\r\n    medium: 'var(--font-weight-medium, 500)',\r\n    semibold: 'var(--font-weight-semibold, 600)',\r\n    bold: 'var(--font-weight-bold, 700)'\r\n  }\r\n};","/**\r\n * Virtual File Explorer Component\r\n * A KISS (Keep It Simple, Stupid) but better implementation of file management\r\n * \r\n * Features:\r\n * - Virtual file system navigation\r\n * - Drag & drop support\r\n * - Context menu operations\r\n * - Search and filtering\r\n * - Multiple view modes (list, grid)\r\n * - Keyboard shortcuts\r\n * - Performance optimized with virtual scrolling\r\n */\r\n\r\nimport { StyledComponent, createStyles, css, colors, spacing, typography } from '../../core/styling/styled-component.js';\r\nimport type { ComponentStyles } from '../../core/styling/component-style-manager.js';\r\nimport { eventBus } from '../../core/events/event-bus.js';\r\nimport { serviceContainer, SERVICE_TOKENS } from '../../core/di/service-container.js';\r\nimport type { IAuthService } from '../../core/types/index.js';\r\n \r\n// File System Types (simplified from Angular version)\r\nexport interface VfsFileItem {\r\n  name: string;\r\n  size?: number;\r\n  modifiedDate?: string;\r\n  type?: string;\r\n  isDirectory?: boolean;\r\n  path?: string;\r\n  icon?: string;\r\n  children?: VfsFileItem[];\r\n  inTrash?: boolean;\r\n  isLocked?: boolean;\r\n}\r\n\r\nexport interface VfsNavigationState {\r\n  currentPath: string;\r\n  selectedFiles: VfsFileItem[];\r\n  viewMode: 'list' | 'grid';\r\n  sortBy: 'name' | 'date' | 'size' | 'type';\r\n  sortDirection: 'asc' | 'desc';\r\n  filterText: string;\r\n}\r\n\r\nexport interface VfsOperation {\r\n  type: 'create' | 'delete' | 'rename' | 'move' | 'copy';\r\n  source?: VfsFileItem[];\r\n  target?: string;\r\n  data?: any;\r\n}\r\n\r\nexport interface ClipboardData {\r\n  operation: 'copy' | 'cut';\r\n  files: VfsFileItem[];\r\n  sourcePath: string;\r\n}\r\n\r\nexport class FileExplorerComponent extends StyledComponent {\r\n  private authService!: IAuthService;\r\n\r\n  protected override async onBeforeMount(): Promise<void> {\r\n    console.log('FileExplorer: onBeforeMount called');\r\n    try {\r\n      // Get auth service\r\n      this.authService = serviceContainer.get(SERVICE_TOKENS.AUTH_SERVICE);\r\n      console.log('FileExplorer: Auth service obtained:', !!this.authService);\r\n    } catch (error) {\r\n      console.error('FileExplorer: Failed to get auth service:', error);\r\n    }\r\n    \r\n    await super.onBeforeMount();\r\n  }\r\n  private explorerState: VfsNavigationState = {\r\n    currentPath: '',\r\n    selectedFiles: [],\r\n    viewMode: 'list',\r\n    sortBy: 'name',\r\n    sortDirection: 'asc',\r\n    filterText: ''\r\n  };\r\n\r\n  private files: VfsFileItem[] = [];\r\n  private filteredFiles: VfsFileItem[] = [];\r\n  private history: string[] = [''];\r\n  private historyIndex: number = 0;\r\n  private isLoading = false;\r\n  private dragState: { isDragging: boolean; dragFiles: VfsFileItem[] } = {\r\n    isDragging: false,\r\n    dragFiles: []\r\n  };\r\n  private clipboard: ClipboardData | null = null;\r\n\r\n  // Virtual scrolling for performance\r\n  private virtualScrollContainer?: HTMLElement;\r\n  private visibleStartIndex = 0;\r\n  private visibleEndIndex = 50; // Show 50 items at a time\r\n  private itemHeight = 32; // Height of each file item in list view\r\n\r\n  protected getStyles(): ComponentStyles {\r\n    return createStyles({\r\n      styles: [\r\n        {\r\n          selector: '.file-explorer',\r\n          properties: {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            height: '100%',\r\n              width: '100%',\r\n            backgroundColor: colors.background,\r\n            fontFamily: typography.fontFamily,\r\n            fontSize: typography.fontSize.sm,\r\n              overflow: 'hidden',\r\n              border: `1px solid ${colors.surface}`,\r\n              borderRadius: '6px'\r\n          }\r\n        },\r\n        {\r\n          selector: '.toolbar',\r\n          properties: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            padding: spacing.sm,\r\n            borderBottom: `1px solid ${colors.surface}`,\r\n            gap: spacing.sm,\r\n            backgroundColor: colors.surface,\r\n              flexShrink: '0',\r\n              minHeight: '48px',\r\n              width: '100%',\r\n              boxSizing: 'border-box'\r\n          }\r\n        },\r\n        {\r\n          selector: '.nav-buttons',\r\n          properties: {\r\n            display: 'flex',\r\n            gap: spacing.xs\r\n          }\r\n        },\r\n        {\r\n          selector: '.nav-btn',\r\n          properties: {\r\n              padding: `${spacing.xs} ${spacing.sm}`,\r\n              border: `1px solid ${colors.surface}`,\r\n            borderRadius: '4px',\r\n              backgroundColor: colors.background,\r\n              color: colors.text,\r\n            cursor: 'pointer',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n              minWidth: '32px',\r\n              height: '32px',\r\n              fontSize: typography.fontSize.sm,\r\n              fontWeight: typography.fontWeight.medium,\r\n              transition: 'all 0.15s ease'\r\n          }\r\n        },\r\n        {\r\n          selector: '.nav-btn:hover:not(:disabled)',\r\n          properties: {\r\n              backgroundColor: colors.primary,\r\n              color: colors.background,\r\n              borderColor: colors.primary\r\n          }\r\n        },\r\n        {\r\n          selector: '.nav-btn:disabled',\r\n          properties: {\r\n              opacity: '0.4',\r\n              cursor: 'not-allowed',\r\n              backgroundColor: colors.surface,\r\n              color: colors.textSecondary\r\n          }\r\n        },\r\n        {\r\n          selector: '.address-bar',\r\n          properties: {\r\n            flex: '1',\r\n              padding: `${spacing.sm} ${spacing.md}`,\r\n            border: `1px solid ${colors.surface}`,\r\n            borderRadius: '4px',\r\n            fontSize: typography.fontSize.sm,\r\n                    backgroundColor: colors.background,\r\n                    color: colors.text,\r\n                    outline: 'none',\r\n                    minWidth: '0'\r\n                }\r\n            },\r\n            {\r\n                selector: '.address-bar:focus',\r\n                properties: {\r\n                    borderColor: colors.primary,\r\n                    boxShadow: `0 0 0 2px ${colors.primary}20`\r\n          }\r\n        },\r\n        {\r\n          selector: '.search-box',\r\n          properties: {\r\n            width: '200px',\r\n              padding: `${spacing.sm} ${spacing.md}`,\r\n            border: `1px solid ${colors.surface}`,\r\n            borderRadius: '4px',\r\n            fontSize: typography.fontSize.sm,\r\n              backgroundColor: colors.background,\r\n              color: colors.text,\r\n            outline: 'none'\r\n          }\r\n        },\r\n        {\r\n                selector: '.search-box:focus',\r\n                properties: {\r\n                    borderColor: colors.primary,\r\n                    boxShadow: `0 0 0 2px ${colors.primary}20`\r\n                }\r\n            },\r\n            {\r\n          selector: '.view-controls',\r\n          properties: {\r\n            display: 'flex',\r\n            gap: spacing.xs\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-list-container',\r\n          properties: {\r\n            flex: '1',\r\n            overflow: 'auto',\r\n              position: 'relative',\r\n              backgroundColor: colors.background,\r\n              minHeight: '200px'\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-list',\r\n          properties: {\r\n            padding: spacing.sm,\r\n            minHeight: '100%'\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-item',\r\n          properties: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n              padding: `${spacing.sm} ${spacing.md}`,\r\n            borderRadius: '4px',\r\n            cursor: 'pointer',\r\n              transition: 'all 0.15s ease',\r\n            gap: spacing.sm,\r\n              minHeight: '40px',\r\n              userSelect: 'none',\r\n              border: '1px solid transparent'\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-item:hover',\r\n          properties: {\r\n              backgroundColor: colors.surface,\r\n              borderColor: colors.surface\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-item.selected',\r\n          properties: {\r\n            backgroundColor: colors.primary + '30',\r\n              color: colors.primary,\r\n              borderColor: colors.primary,\r\n              borderWidth: '2px',\r\n              fontWeight: typography.fontWeight.semibold\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-icon',\r\n          properties: {\r\n              width: '5px',\r\n              height: '5px',\r\n              flexShrink: '0',\r\n              fontSize: '16px',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center'\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-name',\r\n          properties: {\r\n            flex: '1',\r\n            overflow: 'hidden',\r\n            textOverflow: 'ellipsis',\r\n              whiteSpace: 'nowrap',\r\n              fontSize: typography.fontSize.sm,\r\n              fontWeight: typography.fontWeight.medium\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-size',\r\n          properties: {\r\n              width: '100px',\r\n            textAlign: 'right',\r\n            color: colors.textSecondary,\r\n              fontSize: typography.fontSize.xs,\r\n              fontFamily: 'monospace'\r\n          }\r\n        },\r\n        {\r\n          selector: '.file-date',\r\n          properties: {\r\n              width: '140px',\r\n            textAlign: 'right',\r\n            color: colors.textSecondary,\r\n              fontSize: typography.fontSize.xs,\r\n              fontFamily: 'monospace'\r\n          }\r\n        },\r\n        {\r\n          selector: '.loading',\r\n          properties: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            height: '100px',\r\n            color: colors.textSecondary\r\n          }\r\n        },\r\n        {\r\n          selector: '.empty-state',\r\n          properties: {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            height: '200px',\r\n            color: colors.textSecondary,\r\n            gap: spacing.md\r\n          }\r\n        },\r\n        {\r\n          selector: '.drag-overlay',\r\n          properties: {\r\n            position: 'fixed',\r\n            top: '0',\r\n            left: '0',\r\n            right: '0',\r\n            bottom: '0',\r\n            backgroundColor: colors.primary + '10',\r\n            border: `2px dashed ${colors.primary}`,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            fontSize: typography.fontSize.lg,\r\n            color: colors.primary,\r\n            zIndex: '999',\r\n            pointerEvents: 'none'\r\n          }\r\n        }\r\n      ],\r\n      globals: [\r\n        {\r\n          selector: '.context-menu',\r\n          properties: {\r\n            position: 'fixed',\r\n            backgroundColor: colors.background,\r\n            border: `1px solid ${colors.surface}`,\r\n            borderRadius: '6px',\r\n            boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\r\n            padding: spacing.xs,\r\n            zIndex: '1000',\r\n            minWidth: '160px'\r\n          }\r\n        },\r\n        {\r\n          selector: '.context-menu-item',\r\n          properties: {\r\n            padding: `${spacing.xs} ${spacing.sm}`,\r\n            cursor: 'pointer',\r\n            borderRadius: '4px',\r\n            fontSize: typography.fontSize.sm,\r\n            transition: 'background-color 0.15s ease'\r\n          }\r\n        },\r\n        {\r\n          selector: '.context-menu-item:hover',\r\n          properties: {\r\n            backgroundColor: colors.surface\r\n          }\r\n        }\r\n      ]\r\n    }, this.componentId);\r\n  }\r\n\r\n  protected override async render(): Promise<void> {\r\n    try {\r\n      // Ensure the container takes up the full space\r\n      this.container.style.height = '100%';\r\n      this.container.style.width = '100%';\r\n      this.container.style.overflow = 'hidden';\r\n      this.container.style.display = 'flex';\r\n      this.container.style.flexDirection = 'column';\r\n\r\n      console.log('File Explorer rendering...');\r\n      console.log('Scope ID:', this.scopeId);\r\n      console.log('Component ID:', this.componentId);\r\n\r\n      // Test className generation\r\n      const testClass = this.className('toolbar');\r\n      console.log('Generated toolbar class:', testClass);\r\n\r\n      // Debug: Check if styles are in DOM\r\n      const styleElements = document.querySelectorAll('style[data-component-styles]');\r\n      console.log('Style elements in DOM:', styleElements.length);\r\n      styleElements.forEach(el => {\r\n          console.log('Style element for:', el.getAttribute('data-component-styles'));\r\n      });\r\n\r\n      // Force style registration if needed\r\n      if (!this.scopeId) {\r\n          console.warn('No scope ID - manually registering styles');\r\n          const styles = this.getStyles();\r\n          this.registerStyles(styles);\r\n      }\r\n\r\n    this.container.innerHTML = `\r\n      <div class=\"${this.className('file-explorer')}\" style=\"display: flex; flex-direction: column; height: 100%; background: white; border: 1px solid #e5e7eb; border-radius: 6px;\">\r\n        <!-- Toolbar -->\r\n        <div class=\"${this.className('toolbar')}\" style=\"display: flex; align-items: center; padding: 8px; border-bottom: 1px solid #e5e7eb; gap: 8px; background: #f8fafc; min-height: 48px;\">\r\n          <div class=\"${this.className('nav-buttons')}\" style=\"display: flex; gap: 4px;\">\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-back\" title=\"Back\" ${!this.canNavigateBack() ? 'disabled' : ''} style=\"padding: 4px 8px; border: 1px solid #e5e7eb; border-radius: 4px; background: white; cursor: pointer; min-width: 32px; height: 32px;\">\r\n              ←\r\n            </button>\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-forward\" title=\"Forward\" ${!this.canNavigateForward() ? 'disabled' : ''}>\r\n              →\r\n            </button>\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-up\" title=\"Up\" ${!this.explorerState.currentPath ? 'disabled' : ''}>\r\n              ↑\r\n            </button>\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-refresh\" title=\"Refresh\">\r\n              ⟳\r\n            </button>\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-upload\" title=\"Upload Files\">\r\n              ↑\r\n            </button>\r\n          </div>\r\n          \r\n          <input \r\n            type=\"text\" \r\n            class=\"${this.className('address-bar')}\" \r\n            id=\"address-bar\"\r\n            placeholder=\"Path...\"\r\n            value=\"${this.explorerState.currentPath || '/'}\"\r\n            style=\"flex: 1; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 4px; background: white; outline: none;\"\r\n          />\r\n          \r\n          <input \r\n            type=\"text\" \r\n            class=\"${this.className('search-box')}\" \r\n            id=\"search-box\"\r\n            placeholder=\"Search files...\"\r\n            value=\"${this.explorerState.filterText}\"\r\n            style=\"width: 200px; padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 4px; background: white; outline: none;\"\r\n          />\r\n          \r\n          <div class=\"${this.className('view-controls')}\" style=\"display: flex; gap: 4px;\">\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-list\" title=\"List View\" style=\"padding: 4px 8px; border: 1px solid #e5e7eb; border-radius: 4px; background: white; cursor: pointer; min-width: 32px; height: 32px;\">\r\n              ☰\r\n            </button>\r\n            <button class=\"${this.className('nav-btn')}\" id=\"btn-grid\" title=\"Grid View\" style=\"padding: 4px 8px; border: 1px solid #e5e7eb; border-radius: 4px; background: white; cursor: pointer; min-width: 32px; height: 32px;\">\r\n              ⊞\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- File List Container -->\r\n        <div class=\"${this.className('file-list-container')}\" id=\"file-list-container\" style=\"flex: 1; overflow: auto; background: white; min-height: 200px;\">\r\n          ${this.renderFileList()}\r\n        </div>\r\n        \r\n        <!-- Debug Panel -->\r\n        <div style=\"padding: 8px; border-top: 1px solid #e5e7eb; background: #f8fafc; font-size: 12px; font-family: monospace;\">\r\n          <div>Path: ${this.explorerState.currentPath || '/'}</div>\r\n          <div>Files: ${this.files.length}, Filtered: ${this.filteredFiles.length}</div>\r\n          <div>Loading: ${this.isLoading}</div>\r\n          <div>Auth: ${this.authService ? 'Service OK' : 'No Service'}</div>\r\n          <div style=\"margin-top: 4px; color: #059669; font-weight: bold;\">💡 Single-click folders to open them, Ctrl+click to select</div>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    // Setup event listeners\r\n    this.setupEventListeners();\r\n    \r\n    // Load initial files\r\n    try {\r\n      console.log('FileExplorer: About to call loadFiles');\r\n      await this.loadFiles(this.explorerState.currentPath);\r\n      console.log('FileExplorer: loadFiles completed');\r\n      this.updateNavigationButtons();\r\n    } catch (error) {\r\n      console.error('FileExplorer: Error in loadFiles:', error);\r\n    }\r\n  } catch (error) {\r\n    console.error('FileExplorer: Error in render method:', error);\r\n  }\r\n}\r\n\r\n  private renderFileList(): string {\r\n    if (this.isLoading) {\r\n      return `<div class=\"${this.className('loading')}\">Loading files...</div>`;\r\n    }\r\n\r\n    if (this.filteredFiles.length === 0) {\r\n      return `\r\n        <div class=\"${this.className('empty-state')}\">\r\n          <div>📁</div>\r\n          <div>No files found</div>\r\n          ${this.explorerState.filterText ? `<div>Try clearing the search filter</div>` : ''}\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    const visibleFiles = this.filteredFiles.slice(this.visibleStartIndex, this.visibleEndIndex);\r\n    \r\n    return `\r\n      <div class=\"${this.className('file-list')}\" id=\"file-list\" style=\"padding: 8px; min-height: 100%;\">\r\n        ${visibleFiles.map((file, index) => this.renderFileItem(file, this.visibleStartIndex + index)).join('')}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private renderFileItem(file: VfsFileItem, index: number): string {\r\n    const isSelected = this.explorerState.selectedFiles.some((f: VfsFileItem) => f.path === file.path);\r\n    const icon = this.getFileIcon(file);\r\n    const size = file.isDirectory ? '' : this.formatFileSize(file.size || 0);\r\n    const date = file.modifiedDate ? new Date(file.modifiedDate).toLocaleDateString() : '';\r\n\r\n    return `\r\n      <div \r\n        class=\"${this.className('file-item')} ${isSelected ? 'selected' : ''}\" \r\n        data-file-index=\"${index}\"\r\n        data-file-path=\"${file.path || file.name}\"\r\n        draggable=\"true\"\r\n        style=\"display: flex; align-items: center; padding: 8px 12px; border-radius: 4px; cursor: pointer; gap: 8px; min-height: 40px; border: 1px solid transparent; transition: background-color 0.15s ease;\"\r\n      >\r\n        <div class=\"${this.className('file-icon')}\" style=\"width: 5px; height: 5px; flex-shrink: 0; display: flex; align-items: center; justify-content: center;\">${icon}</div>\r\n        <div class=\"${this.className('file-name')}\" title=\"${file.name}\" style=\"flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-weight: 500;\">${file.name}</div>\r\n        <div class=\"${this.className('file-size')}\" style=\"width: 100px; text-align: right; color: #6b7280; font-size: 12px; font-family: monospace;\">${size}</div>\r\n        <div class=\"${this.className('file-date')}\" style=\"width: 140px; text-align: right; color: #6b7280; font-size: 12px; font-family: monospace;\">${date}</div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n    // Navigation buttons\r\n    this.addEventListener(this.container.querySelector('#btn-back')!, 'click', () => this.navigateBack());\r\n    this.addEventListener(this.container.querySelector('#btn-forward')!, 'click', () => this.navigateForward());\r\n    this.addEventListener(this.container.querySelector('#btn-up')!, 'click', () => this.navigateUp());\r\n    this.addEventListener(this.container.querySelector('#btn-refresh')!, 'click', () => this.refresh());\r\n    this.addEventListener(this.container.querySelector('#btn-upload')!, 'click', () => this.triggerFileUpload());\r\n\r\n    // Address bar\r\n    const addressBar = this.container.querySelector('#address-bar') as HTMLInputElement;\r\n    this.addEventListener(addressBar, 'keydown', (e) => {\r\n      if (e.key === 'Enter') {\r\n        this.navigateToPath(addressBar.value);\r\n      }\r\n    });\r\n\r\n    // Search box\r\n    const searchBox = this.container.querySelector('#search-box') as HTMLInputElement;\r\n    this.addEventListener(searchBox, 'input', this.debounce(() => {\r\n      this.explorerState.filterText = searchBox.value;\r\n      this.applyFilter();\r\n      this.updateFileList();\r\n      this.updateDebugPanel();\r\n    }, 300));\r\n\r\n    // View mode buttons\r\n    this.addEventListener(this.container.querySelector('#btn-list')!, 'click', () => this.setViewMode('list'));\r\n    this.addEventListener(this.container.querySelector('#btn-grid')!, 'click', () => this.setViewMode('grid'));\r\n\r\n    // File list interactions\r\n    const fileListContainer = this.container.querySelector('#file-list-container') as HTMLElement;\r\n    this.addEventListener(fileListContainer, 'click', (e) => this.handleFileClick(e));\r\n    this.addEventListener(fileListContainer, 'dblclick', (e) => this.handleFileDoubleClick(e));\r\n    this.addEventListener(fileListContainer, 'contextmenu', (e) => this.handleContextMenu(e));\r\n\r\n    // Drag and drop\r\n    this.addEventListener(fileListContainer, 'dragstart', (e) => this.handleDragStart(e));\r\n    this.addEventListener(fileListContainer, 'dragover', (e) => this.handleDragOver(e));\r\n    this.addEventListener(fileListContainer, 'drop', (e) => this.handleDrop(e));\r\n    this.addEventListener(fileListContainer, 'dragleave', (e) => this.handleDragLeave(e));\r\n\r\n    // Virtual scrolling\r\n    this.addEventListener(fileListContainer, 'scroll', this.debounce(() => this.updateVirtualScroll(), 16));\r\n\r\n    // Keyboard shortcuts will be handled by window focus\r\n    // Context menu will be closed on outside click\r\n    window.addEventListener('click', (e) => {\r\n      const menu = document.getElementById('context-menu');\r\n      if (menu && !menu.contains(e.target as Node) && e.target !== menu) {\r\n        console.log('FileExplorer: closing context menu due to outside click');\r\n        this.closeContextMenu();\r\n      }\r\n    });\r\n    window.addEventListener('keydown', (e) => this.handleKeyboardShortcuts(e));\r\n  }\r\n\r\n  private handleKeyboardShortcuts(e: KeyboardEvent): void {\r\n    if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) {\r\n      return; // Don't handle shortcuts when typing in inputs\r\n    }\r\n\r\n    if (e.ctrlKey || e.metaKey) {\r\n      switch (e.key.toLowerCase()) {\r\n        case 'c':\r\n          e.preventDefault();\r\n          this.showError('Copy operation is not supported by the current VFS API');\r\n          break;\r\n        case 'x':\r\n          e.preventDefault();\r\n          this.showError('Cut operation is not supported by the current VFS API');\r\n          break;\r\n        case 'v':\r\n          e.preventDefault();\r\n          this.showError('Paste operation is not supported by the current VFS API');\r\n          break;\r\n        case 'a':\r\n          e.preventDefault();\r\n          this.selectAll();\r\n          break;\r\n      }\r\n    } else if (e.key === 'Delete' || e.key === 'Backspace') {\r\n      if (this.explorerState.selectedFiles.length > 0) {\r\n        this.deleteFiles(this.explorerState.selectedFiles);\r\n      }\r\n    } else if (e.key === 'F2') {\r\n      if (this.explorerState.selectedFiles.length === 1) {\r\n        this.renameFile(this.explorerState.selectedFiles[0]!);\r\n      }\r\n    } else if (e.key === 'F5') {\r\n      this.refresh();\r\n    }\r\n  }\r\n\r\n  private selectAll(): void {\r\n    this.explorerState.selectedFiles = [...this.filteredFiles];\r\n    this.updateFileList();\r\n    this.updateDebugPanel();\r\n  }\r\n\r\n  // Navigation methods\r\n  private canNavigateBack(): boolean {\r\n    return this.historyIndex > 0;\r\n  }\r\n\r\n  private canNavigateForward(): boolean {\r\n    return this.historyIndex < this.history.length - 1;\r\n  }\r\n\r\n  private async navigateBack(): Promise<void> {\r\n    console.log('FileExplorer: navigateBack called, canNavigateBack:', this.canNavigateBack(), 'historyIndex:', this.historyIndex, 'history:', this.history);\r\n    if (this.canNavigateBack()) {\r\n      this.historyIndex--;\r\n      const path = this.history[this.historyIndex];\r\n      console.log('FileExplorer: navigating back to:', path);\r\n      if (path !== undefined) {\r\n        await this.loadFiles(path);\r\n        this.updateNavigationButtons();\r\n      }\r\n    }\r\n  }\r\n\r\n  private async navigateForward(): Promise<void> {\r\n    console.log('FileExplorer: navigateForward called, canNavigateForward:', this.canNavigateForward(), 'historyIndex:', this.historyIndex, 'history:', this.history);\r\n    if (this.canNavigateForward()) {\r\n      this.historyIndex++;\r\n      const path = this.history[this.historyIndex];\r\n      console.log('FileExplorer: navigating forward to:', path);\r\n      if (path !== undefined) {\r\n        await this.loadFiles(path);\r\n        this.updateNavigationButtons();\r\n      }\r\n    }\r\n  }\r\n\r\n  private async navigateUp(): Promise<void> {\r\n    if (!this.explorerState.currentPath) return;\r\n    \r\n    const parentPath = this.explorerState.currentPath.split('/').slice(0, -1).join('/');\r\n    await this.navigateToPath(parentPath);\r\n  }\r\n\r\n  private async navigateToPath(path: string): Promise<void> {\r\n    console.log('FileExplorer: navigateToPath called with:', path);\r\n    const normalizedPath = path.startsWith('/') ? path.substring(1) : path;\r\n    console.log('FileExplorer: navigateToPath normalized path:', normalizedPath);\r\n    \r\n    // Add to history if it's a new path\r\n    if (normalizedPath !== this.explorerState.currentPath) {\r\n      this.history = this.history.slice(0, this.historyIndex + 1);\r\n      this.history.push(normalizedPath);\r\n      this.historyIndex = this.history.length - 1;\r\n    }\r\n    \r\n    console.log('FileExplorer: navigateToPath calling loadFiles with:', normalizedPath);\r\n    await this.loadFiles(normalizedPath);\r\n    console.log('FileExplorer: navigateToPath completed');\r\n  }\r\n\r\n  private async refresh(): Promise<void> {\r\n    await this.loadFiles(this.explorerState.currentPath);\r\n  }\r\n\r\n  // File operations\r\n  private async loadFiles(path: string): Promise<void> {\r\n    console.log('FileExplorer: loadFiles called with path:', path);\r\n    this.isLoading = true;\r\n    this.updateFileList();\r\n    this.updateDebugPanel();\r\n    \r\n    try {\r\n      // Check if user is authenticated\r\n      const isAuthenticated = this.authService.isAuthenticated();\r\n      console.log('FileExplorer: User authenticated:', isAuthenticated);\r\n      if (!isAuthenticated) {\r\n        console.warn('User not authenticated, cannot load files from server');\r\n        this.files = [];\r\n        return;\r\n      }\r\n\r\n      // Call actual VFS API\r\n      console.log('FileExplorer: Calling loadFilesFromAPI');\r\n      this.files = await this.loadFilesFromAPI(path);\r\n      console.log('FileExplorer: Loaded files:', this.files.length);\r\n      this.explorerState.currentPath = path;\r\n      this.applyFilter();\r\n      this.updateDebugPanel();\r\n      this.updateNavigationButtons();\r\n      this.explorerState.selectedFiles = [];\r\n      \r\n      // Update address bar\r\n      const addressBar = this.container.querySelector('#address-bar') as HTMLInputElement;\r\n      if (addressBar) {\r\n        addressBar.value = path || '/';\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to load files:', error);\r\n      // Show error to user\r\n      this.showError('Failed to load files: ' + (error instanceof Error ? error.message : 'Unknown error'));\r\n      this.files = [];\r\n    } finally {\r\n      this.isLoading = false;\r\n      this.updateFileList();\r\n      this.updateDebugPanel();\r\n    }\r\n  }\r\n\r\n  private applyFilter(): void {\r\n    let filtered = [...this.files];\r\n    \r\n    // Apply text filter\r\n    if (this.explorerState.filterText) {\r\n      const query = this.explorerState.filterText.toLowerCase();\r\n      filtered = filtered.filter(file => \r\n        file.name.toLowerCase().includes(query)\r\n      );\r\n    }\r\n    \r\n    // Apply sorting\r\n    filtered.sort((a, b) => {\r\n      let comparison = 0;\r\n      \r\n      switch (this.explorerState.sortBy) {\r\n        case 'name':\r\n          comparison = a.name.localeCompare(b.name);\r\n          break;\r\n        case 'date':\r\n          const dateA = new Date(a.modifiedDate || 0).getTime();\r\n          const dateB = new Date(b.modifiedDate || 0).getTime();\r\n          comparison = dateA - dateB;\r\n          break;\r\n        case 'size':\r\n          comparison = (a.size || 0) - (b.size || 0);\r\n          break;\r\n        case 'type':\r\n          comparison = (a.type || '').localeCompare(b.type || '');\r\n          break;\r\n      }\r\n      \r\n      return this.explorerState.sortDirection === 'desc' ? -comparison : comparison;\r\n    });\r\n    \r\n    this.filteredFiles = filtered;\r\n  }\r\n\r\n  private updateFileList(): void {\r\n    const container = this.container.querySelector('#file-list-container');\r\n    if (container) {\r\n      container.innerHTML = this.renderFileList();\r\n    }\r\n  }\r\n\r\n  private triggerFileUpload(): void {\r\n    // Create a hidden file input\r\n    const input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.multiple = true;\r\n    input.style.display = 'none';\r\n    \r\n    input.addEventListener('change', async (e) => {\r\n      const target = e.target as HTMLInputElement;\r\n      const files = Array.from(target.files || []);\r\n      if (files.length > 0) {\r\n        await this.uploadFiles(files);\r\n      }\r\n      // Remove the input after use\r\n      document.body.removeChild(input);\r\n    });\r\n    \r\n    document.body.appendChild(input);\r\n    input.click();\r\n  }\r\n\r\n  private updateNavigationButtons(): void {\r\n    const backBtn = this.container.querySelector('#btn-back') as HTMLButtonElement;\r\n    const forwardBtn = this.container.querySelector('#btn-forward') as HTMLButtonElement;\r\n    const upBtn = this.container.querySelector('#btn-up') as HTMLButtonElement;\r\n    \r\n    const canBack = this.canNavigateBack();\r\n    const canForward = this.canNavigateForward();\r\n    const canUp = !(!this.explorerState.currentPath || this.explorerState.currentPath === '');\r\n    \r\n    console.log('FileExplorer: updateNavigationButtons - canBack:', canBack, 'canForward:', canForward, 'canUp:', canUp, 'currentPath:', this.explorerState.currentPath);\r\n    \r\n    if (backBtn) {\r\n      backBtn.disabled = !canBack;\r\n    }\r\n    if (forwardBtn) {\r\n      forwardBtn.disabled = !canForward;\r\n    }\r\n    if (upBtn) {\r\n      upBtn.disabled = !canUp;\r\n    }\r\n  }\r\n\r\n  private updateDebugPanel(): void {\r\n    const debugPanel = this.container.querySelector('.debug-panel');\r\n    if (debugPanel) {\r\n      debugPanel.innerHTML = `\r\n        <div>Path: ${this.explorerState.currentPath || '/'}</div>\r\n        <div>Files: ${this.files.length}, Filtered: ${this.filteredFiles.length}</div>\r\n        <div>Loading: ${this.isLoading}</div>\r\n        <div>Auth: ${this.authService ? 'Service OK' : 'No Service'}</div>\r\n      `;\r\n    }\r\n  }\r\n\r\n  // Event handlers\r\n  private handleFileClick(e: Event): void {\r\n    const target = e.target as HTMLElement;\r\n    const fileItem = target.closest('[data-file-path]') as HTMLElement;\r\n    console.log('FileExplorer: handleFileClick - target:', target, 'fileItem:', fileItem);\r\n    if (!fileItem) return;\r\n    \r\n    const filePath = fileItem.dataset.filePath!;\r\n    console.log('FileExplorer: handleFileClick - filePath from data attribute:', filePath);\r\n    const file = this.filteredFiles.find(f => (f.path || f.name) === filePath);\r\n    console.log('FileExplorer: handleFileClick - found file:', file);\r\n    if (!file) return;\r\n    \r\n    // Handle selection and navigation\r\n    const mouseEvent = e as MouseEvent;\r\n    if (mouseEvent.ctrlKey || mouseEvent.metaKey) {\r\n      // Multi-select mode - just select/deselect\r\n      const isSelected = this.explorerState.selectedFiles.some((f: VfsFileItem) => f.path === file.path);\r\n      if (isSelected) {\r\n        this.explorerState.selectedFiles = this.explorerState.selectedFiles.filter((f: VfsFileItem) => f.path !== file.path);\r\n      } else {\r\n        this.explorerState.selectedFiles.push(file);\r\n      }\r\n    } else {\r\n      // Single-click behavior\r\n      if (file.isDirectory) {\r\n        // Navigate into directories on single-click\r\n        console.log('FileExplorer: handleFileClick - navigating into directory:', file.path || file.name);\r\n        this.navigateToPath(file.path || file.name);\r\n        return;\r\n      } else {\r\n        // Single select for files\r\n        this.explorerState.selectedFiles = [file];\r\n      }\r\n    }\r\n    \r\n    console.log('FileExplorer: handleFileClick - selected files after click:', this.explorerState.selectedFiles.length, this.explorerState.selectedFiles);\r\n    this.updateFileList();\r\n    this.updateDebugPanel();\r\n  }  private async handleFileDoubleClick(e: Event): Promise<void> {\r\n    const target = e.target as HTMLElement;\r\n    const fileItem = target.closest('[data-file-path]') as HTMLElement;\r\n    console.log('FileExplorer: handleFileDoubleClick - target:', target, 'fileItem:', fileItem);\r\n    if (!fileItem) return;\r\n    \r\n    const filePath = fileItem.dataset.filePath!;\r\n    console.log('FileExplorer: handleFileDoubleClick - filePath from data attribute:', filePath);\r\n    const file = this.filteredFiles.find(f => (f.path || f.name) === filePath);\r\n    console.log('FileExplorer: handleFileDoubleClick - found file:', file, 'isDirectory:', file?.isDirectory);\r\n    if (!file) return;\r\n    \r\n    if (file.isDirectory) {\r\n      // Double-click on directories also navigates (alternative to single-click)\r\n      console.log('FileExplorer: handleFileDoubleClick - navigating into directory:', file.path || file.name);\r\n      await this.navigateToPath(file.path || file.name);\r\n    } else {\r\n      // Double-click on files opens them\r\n      console.log('FileExplorer: handleFileDoubleClick - opening file:', file.name);\r\n      await this.openFile(file);\r\n    }\r\n  }\r\n\r\n  private handleContextMenu(e: Event): void {\r\n    e.preventDefault();\r\n    \r\n    const target = e.target as HTMLElement;\r\n    const fileItem = target.closest('[data-file-path]') as HTMLElement;\r\n    \r\n    const mouseEvent = e as MouseEvent;\r\n    this.showContextMenu(mouseEvent.clientX, mouseEvent.clientY, fileItem?.dataset.filePath);\r\n  }\r\n\r\n  private handleDragStart(e: Event): void {\r\n    const dragEvent = e as DragEvent;\r\n    const target = dragEvent.target as HTMLElement;\r\n    const fileItem = target.closest('[data-file-path]') as HTMLElement;\r\n    if (!fileItem || !dragEvent.dataTransfer) return;\r\n    \r\n    const filePath = fileItem.dataset.filePath!;\r\n    const file = this.filteredFiles.find(f => (f.path || f.name) === filePath);\r\n    if (!file) return;\r\n    \r\n    // Set drag data\r\n    this.dragState.isDragging = true;\r\n    this.dragState.dragFiles = this.explorerState.selectedFiles.includes(file) \r\n      ? this.explorerState.selectedFiles \r\n      : [file];\r\n    \r\n    dragEvent.dataTransfer.setData('text/plain', JSON.stringify(this.dragState.dragFiles));\r\n    dragEvent.dataTransfer.effectAllowed = 'move';\r\n  }\r\n\r\n  private handleDragOver(e: Event): void {\r\n    e.preventDefault();\r\n    const dragEvent = e as DragEvent;\r\n    if (dragEvent.dataTransfer) {\r\n      dragEvent.dataTransfer.dropEffect = 'move';\r\n    }\r\n  }\r\n\r\n  private handleDragLeave(e: Event): void {\r\n    // Optional: Handle drag leave effects\r\n  }\r\n\r\n  private async handleDrop(e: Event): Promise<void> {\r\n    e.preventDefault();\r\n    const dragEvent = e as DragEvent;\r\n    \r\n    // Handle external file drops\r\n    if (dragEvent.dataTransfer?.files.length) {\r\n      await this.handleExternalFileDrop(dragEvent);\r\n      return;\r\n    }\r\n    \r\n    // Handle internal file moves\r\n    const data = dragEvent.dataTransfer?.getData('text/plain');\r\n    if (data) {\r\n      try {\r\n        const draggedFiles = JSON.parse(data) as VfsFileItem[];\r\n        const target = (dragEvent.target as HTMLElement).closest('[data-file-path]') as HTMLElement;\r\n        const targetPath = target?.dataset.filePath || this.explorerState.currentPath;\r\n        \r\n        await this.moveFiles(draggedFiles, targetPath);\r\n      } catch (error) {\r\n        console.error('Failed to handle file drop:', error);\r\n      }\r\n    }\r\n    \r\n    this.dragState.isDragging = false;\r\n    this.dragState.dragFiles = [];\r\n  }\r\n\r\n  private handleKeyboard(e: KeyboardEvent): void {\r\n    // Only handle if explorer is focused\r\n    if (!this.container.contains(document.activeElement)) return;\r\n    \r\n    switch (e.key) {\r\n      case 'F5':\r\n        e.preventDefault();\r\n        this.refresh();\r\n        break;\r\n      case 'Delete':\r\n        if (this.explorerState.selectedFiles.length > 0) {\r\n          this.deleteFiles(this.explorerState.selectedFiles);\r\n        }\r\n        break;\r\n      case 'F2':\r\n        if (this.explorerState.selectedFiles.length === 1) {\r\n          const fileToRename = this.explorerState.selectedFiles[0];\r\n          if (fileToRename) {\r\n            this.renameFile(fileToRename);\r\n          }\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        this.explorerState.selectedFiles = [];\r\n        this.updateFileList();\r\n        this.updateDebugPanel();\r\n        this.closeContextMenu();\r\n        break;\r\n    }\r\n  }\r\n\r\n  // Utility methods\r\n  private getFileIcon(file: VfsFileItem): string {\r\n    if (file.isDirectory) return '📁';\r\n    \r\n    const ext = file.name.split('.').pop()?.toLowerCase();\r\n    switch (ext) {\r\n      case 'txt': case 'md': return '📄';\r\n      case 'pdf': return '📕';\r\n      case 'jpg': case 'jpeg': case 'png': case 'gif': return '🖼️';\r\n      case 'mp3': case 'wav': return '🎵';\r\n      case 'mp4': case 'avi': return '🎬';\r\n      case 'zip': case 'rar': return '📦';\r\n      case 'js': case 'ts': case 'html': case 'css': return '💻';\r\n      default: return '📄';\r\n    }\r\n  }\r\n\r\n  private formatFileSize(bytes: number): string {\r\n    if (bytes === 0) return '0 B';\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\r\n  }\r\n\r\n  private debounce<T extends (...args: any[]) => any>(func: T, delay: number): (...args: Parameters<T>) => void {\r\n    let timeoutId: number;\r\n    return (...args: Parameters<T>) => {\r\n      clearTimeout(timeoutId);\r\n      timeoutId = window.setTimeout(() => func.apply(this, args), delay);\r\n    };\r\n  }\r\n\r\n  private setViewMode(mode: 'list' | 'grid'): void {\r\n    this.explorerState.viewMode = mode;\r\n    // TODO: Implement grid view rendering\r\n    this.updateFileList();\r\n    this.updateDebugPanel();\r\n  }\r\n\r\n  private updateVirtualScroll(): void {\r\n    // TODO: Implement virtual scrolling for performance with large file lists\r\n    // This would only render visible items and update as user scrolls\r\n  }\r\n\r\n  private showContextMenu(x: number, y: number, filePath?: string): void {\r\n    this.closeContextMenu();\r\n    \r\n    const file = filePath ? this.filteredFiles.find(f => (f.path || f.name) === filePath) : null;\r\n    const selectedCount = this.explorerState.selectedFiles.length;\r\n    \r\n    const menuItems = [\r\n      ...(file?.isDirectory ? [\r\n        { label: 'Open', action: () => this.navigateToPath(file.path || file.name) }\r\n      ] : [\r\n        { label: 'Open', action: () => this.openFile(file!) }\r\n      ]),\r\n      { label: 'Rename', action: () => this.renameFile(file!), disabled: selectedCount !== 1 },\r\n      { label: 'Delete', action: () => this.deleteFiles(this.explorerState.selectedFiles), disabled: selectedCount === 0 },\r\n      { label: '---' },\r\n      { label: 'Cut', action: () => this.cutFiles(this.explorerState.selectedFiles), disabled: true, tooltip: 'Not supported by current VFS API' },\r\n      { label: 'Copy', action: () => this.copyFiles(this.explorerState.selectedFiles), disabled: true, tooltip: 'Not supported by current VFS API' },\r\n      { label: 'Paste', action: () => this.pasteFiles(), disabled: true, tooltip: 'Not supported by current VFS API' },\r\n      { label: '---' },\r\n      { label: 'New Folder', action: () => this.createFolder() },\r\n      { label: 'New File', action: () => this.createFile() }\r\n    ];\r\n    \r\n    const menu = document.createElement('div');\r\n    menu.className = 'context-menu';\r\n    menu.style.position = 'fixed';\r\n    menu.style.left = `${x}px`;\r\n    menu.style.top = `${y}px`;\r\n    menu.style.zIndex = '10000';\r\n    menu.style.backgroundColor = '#ffffff';\r\n    menu.style.border = '1px solid #e5e7eb';\r\n    menu.style.borderRadius = '6px';\r\n    menu.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';\r\n    menu.style.padding = '4px 0';\r\n    menu.style.minWidth = '160px';\r\n    menu.id = 'context-menu';\r\n    \r\n    menu.innerHTML = menuItems\r\n      .filter(item => item.label !== '---')\r\n      .map(item => `\r\n        <div class=\"context-menu-item\" \r\n             data-action=\"${item.label}\"\r\n             style=\"padding: 8px 12px; cursor: pointer; border-radius: 4px; font-size: 14px; transition: background-color 0.15s ease; ${item.disabled ? 'opacity: 0.5; pointer-events: none;' : 'color: #000000;'}\">\r\n          ${item.label}\r\n        </div>\r\n      `).join('');\r\n    \r\n    document.body.appendChild(menu);\r\n    \r\n    // Add click handlers\r\n    menuItems.forEach(item => {\r\n      if (item.label !== '---' && !item.disabled) {\r\n        const element = menu.querySelector(`[data-action=\"${item.label}\"]`) as HTMLElement;\r\n        if (element && item.action) {\r\n          element.addEventListener('mouseenter', () => {\r\n            element.style.backgroundColor = '#f3f4f6';\r\n          });\r\n          element.addEventListener('mouseleave', () => {\r\n            element.style.backgroundColor = 'transparent';\r\n          });\r\n          element.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n            item.action();\r\n            this.closeContextMenu();\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private closeContextMenu(): void {\r\n    const menu = document.getElementById('context-menu');\r\n    if (menu) {\r\n      menu.remove();\r\n    }\r\n  }\r\n\r\n  // File operation methods (TODO: Implement with actual VFS API)\r\n  private async openFile(file: VfsFileItem): Promise<void> {\r\n    console.log('Opening file:', file.name);\r\n    // Emit event to open file in appropriate editor/viewer\r\n    eventBus.emit('file:open', {\r\n      file,\r\n      path: file.path || file.name,\r\n      fullPath: this.explorerState.currentPath ? `${this.explorerState.currentPath}/${file.name}` : file.name,\r\n      currentDirectory: this.explorerState.currentPath || '/'\r\n    });\r\n  }\r\n\r\n  private async createFolder(): Promise<void> {\r\n    const name = prompt('Folder name:');\r\n    if (name) {\r\n      try {\r\n        await this.createFileOrFolderAPI(name, true);\r\n        await this.refresh();\r\n      } catch (error) {\r\n        console.error('Failed to create folder:', error);\r\n        alert('Failed to create folder');\r\n      }\r\n    }\r\n  }\r\n\r\n  private async createFile(): Promise<void> {\r\n    const name = prompt('File name:');\r\n    if (name) {\r\n      try {\r\n        await this.createFileOrFolderAPI(name, false);\r\n        await this.refresh();\r\n      } catch (error) {\r\n        console.error('Failed to create file:', error);\r\n        alert('Failed to create file');\r\n      }\r\n    }\r\n  }\r\n\r\n  private async deleteFiles(files: VfsFileItem[]): Promise<void> {\r\n    if (confirm(`Delete ${files.length} item(s)?`)) {\r\n      try {\r\n        await this.deleteFilesAPI(files);\r\n        await this.refresh();\r\n      } catch (error) {\r\n        console.error('Failed to delete files:', error);\r\n        alert('Failed to delete files');\r\n      }\r\n    }\r\n  }\r\n\r\n  private async renameFile(file: VfsFileItem): Promise<void> {\r\n    const newName = prompt('New name:', file.name);\r\n    if (newName && newName !== file.name) {\r\n      try {\r\n        await this.renameFileAPI(file, newName);\r\n        await this.refresh();\r\n      } catch (error) {\r\n        console.error('Failed to rename file:', error);\r\n        alert('Failed to rename file');\r\n      }\r\n    }\r\n  }\r\n\r\n  private async moveFiles(files: VfsFileItem[], targetPath: string): Promise<void> {\r\n    // Move operations are not supported by the current VFS API\r\n    throw new Error('Move operations are not supported by the current VFS API');\r\n  }\r\n\r\n  private async copyFiles(files: VfsFileItem[]): Promise<void> {\r\n    console.log('Copying files:', files.map(f => f.name));\r\n    this.clipboard = {\r\n      operation: 'copy',\r\n      files: [...files],\r\n      sourcePath: this.explorerState.currentPath || ''\r\n    };\r\n    console.log('Files copied to clipboard');\r\n  }\r\n\r\n  private async cutFiles(files: VfsFileItem[]): Promise<void> {\r\n    console.log('Cutting files:', files.map(f => f.name));\r\n    this.clipboard = {\r\n      operation: 'cut',\r\n      files: [...files],\r\n      sourcePath: this.explorerState.currentPath || ''\r\n    };\r\n    console.log('Files cut to clipboard');\r\n  }\r\n\r\n  private async pasteFiles(): Promise<void> {\r\n    if (!this.clipboard || this.clipboard.files.length === 0) {\r\n      console.log('No files in clipboard');\r\n      return;\r\n    }\r\n\r\n    console.log('Pasting files:', this.clipboard.files.map(f => f.name));\r\n    try {\r\n      if (this.clipboard.operation === 'copy') {\r\n        await this.copyFilesToCurrentDirectory(this.clipboard.files);\r\n      } else if (this.clipboard.operation === 'cut') {\r\n        await this.moveFilesToCurrentDirectory(this.clipboard.files);\r\n        this.clipboard = null; // Clear clipboard after cut operation\r\n      }\r\n      await this.refresh();\r\n    } catch (error) {\r\n      console.error('Failed to paste files:', error);\r\n      this.showError(error instanceof Error ? error.message : 'Failed to paste files');\r\n    }\r\n  }\r\n\r\n  private async copyFilesToCurrentDirectory(files: VfsFileItem[]): Promise<void> {\r\n    // The VFS API doesn't support downloading file content, so copy operations are not available\r\n    throw new Error('Copy/paste operations are not supported by the current VFS API');\r\n  }\r\n\r\n  private async moveFilesToCurrentDirectory(files: VfsFileItem[]): Promise<void> {\r\n    // Since move API doesn't work and copy isn't supported, move operations are not available\r\n    throw new Error('Move/cut operations are not supported by the current VFS API');\r\n  }\r\n\r\n  private async handleExternalFileDrop(e: DragEvent): Promise<void> {\r\n    const files = Array.from(e.dataTransfer?.files || []);\r\n    console.log('Uploading files:', files.map(f => f.name));\r\n    await this.uploadFiles(files);\r\n  }\r\n\r\n  private async uploadFiles(files: File[]): Promise<void> {\r\n    if (files.length === 0) return;\r\n\r\n    try {\r\n      for (const file of files) {\r\n        await this.uploadFileAPI(file);\r\n      }\r\n      await this.refresh();\r\n      console.log(`Successfully uploaded ${files.length} file(s)`);\r\n    } catch (error) {\r\n      console.error('Failed to upload files:', error);\r\n      this.showError('Failed to upload files');\r\n    }\r\n  }\r\n\r\n  private async uploadFileAPI(file: File): Promise<void> {\r\n    const token = this.authService.getToken();\r\n    if (!token) throw new Error('Not authenticated');\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('path', this.explorerState.currentPath || '');\r\n\r\n    const response = await fetch('/api/files', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${token}`\r\n      },\r\n      body: formData\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`Upload failed: ${errorText}`);\r\n    }\r\n  }\r\n\r\n  // API Methods\r\n  private async createFileOrFolderAPI(name: string, isDirectory: boolean): Promise<void> {\r\n    const headers = this.getAuthHeaders();\r\n    if (!headers) throw new Error('Not authenticated');\r\n\r\n    const response = await fetch('/api/files', {\r\n      method: 'POST',\r\n      headers,\r\n      body: JSON.stringify({\r\n        name,\r\n        isDirectory,\r\n        path: this.explorerState.currentPath\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n    }\r\n  }\r\n\r\n  private async deleteFilesAPI(files: VfsFileItem[]): Promise<void> {\r\n    const headers = this.getAuthHeaders();\r\n    if (!headers) throw new Error('Not authenticated');\r\n\r\n    const deletePromises = files.map(file =>\r\n      fetch(`/api/files/${encodeURIComponent(file.path!)}`, {\r\n        method: 'DELETE',\r\n        headers\r\n      })\r\n    );\r\n\r\n    const results = await Promise.all(deletePromises);\r\n    const failed = results.filter(r => !r.ok);\r\n    if (failed.length > 0) {\r\n      throw new Error(`Failed to delete ${failed.length} files`);\r\n    }\r\n  }\r\n\r\n  private async renameFileAPI(file: VfsFileItem, newName: string): Promise<void> {\r\n    const headers = this.getAuthHeaders();\r\n    if (!headers) throw new Error('Not authenticated');\r\n\r\n    const response = await fetch(`/api/files/${encodeURIComponent(file.path!)}`, {\r\n      method: 'PUT',\r\n      headers,\r\n      body: JSON.stringify({ name: newName })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n    }\r\n  }\r\n\r\n\r\n\r\n  // Mock data for development (TODO: Replace with actual VFS API)\r\n  private async loadFilesFromAPI(path: string): Promise<VfsFileItem[]> {\r\n    console.log('FileExplorer: loadFilesFromAPI called with path:', path);\r\n    try {\r\n      const headers = this.getAuthHeaders();\r\n      console.log('FileExplorer: Auth headers present:', !!headers);\r\n      if (!headers) {\r\n        throw new Error('Not authenticated');\r\n      }\r\n\r\n      const url = `/api/files?path=${encodeURIComponent(path || '/')}`;\r\n      console.log('FileExplorer: Making request to:', url);\r\n      \r\n      const response = await fetch(url, {\r\n        method: 'GET',\r\n        headers\r\n      });\r\n\r\n      console.log('FileExplorer: Response status:', response.status, response.statusText);\r\n      console.log('FileExplorer: Response URL:', response.url);\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        console.error('FileExplorer: API error response:', errorText);\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const files: VfsFileItem[] = await response.json();\r\n      console.log('FileExplorer: API returned files:', files.length, 'files');\r\n      files.forEach((file, index) => {\r\n        console.log(`FileExplorer: File ${index}:`, {\r\n          name: file.name,\r\n          path: file.path,\r\n          isDirectory: file.isDirectory,\r\n          size: file.size,\r\n          modifiedDate: file.modifiedDate\r\n        });\r\n      });\r\n      return files;\r\n    } catch (error) {\r\n      console.error('Failed to load files from API:', error);\r\n      // Fallback to mock data if API fails\r\n      console.log('FileExplorer: Falling back to mock data');\r\n      return this.mockLoadFiles(path);\r\n    }\r\n  }\r\n\r\n  private showError(message: string): void {\r\n    // Simple error display - could be enhanced with a proper error component\r\n    const errorDiv = document.createElement('div');\r\n    errorDiv.style.cssText = `\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 10px;\r\n      background: #ef4444;\r\n      color: white;\r\n      padding: 8px 12px;\r\n      border-radius: 4px;\r\n      font-size: 14px;\r\n      z-index: 1000;\r\n      max-width: 300px;\r\n    `;\r\n    errorDiv.textContent = message;\r\n    this.container.appendChild(errorDiv);\r\n    \r\n    // Remove after 5 seconds\r\n    setTimeout(() => {\r\n      if (errorDiv.parentNode) {\r\n        errorDiv.parentNode.removeChild(errorDiv);\r\n      }\r\n    }, 5000);\r\n  }\r\n\r\n  private getAuthHeaders(): Record<string, string> | null {\r\n    const token = this.authService.getToken();\r\n    console.log('FileExplorer: getAuthHeaders - token present:', !!token);\r\n    if (!token) {\r\n      return null;\r\n    }\r\n    return {\r\n      'Authorization': `Bearer ${token}`,\r\n      'Content-Type': 'application/json'\r\n    };\r\n  }\r\n\r\n  // Fallback mock data for development\r\n  private async mockLoadFiles(path: string): Promise<VfsFileItem[]> {\r\n    // Simulate API delay\r\n    await new Promise(resolve => setTimeout(resolve, 200));\r\n    \r\n    return [\r\n      {\r\n        name: 'Documents',\r\n        isDirectory: true,\r\n        path: 'documents',\r\n        modifiedDate: '2025-09-20T10:00:00Z'\r\n      },\r\n      {\r\n        name: 'Projects',\r\n        isDirectory: true,\r\n        path: 'projects',\r\n        modifiedDate: '2025-09-22T15:30:00Z'\r\n      },\r\n      {\r\n        name: 'readme.txt',\r\n        size: 1024,\r\n        type: 'text/plain',\r\n        path: 'readme.txt',\r\n        modifiedDate: '2025-09-23T08:15:00Z'\r\n      },\r\n      {\r\n        name: 'image.jpg',\r\n        size: 2048576,\r\n        type: 'image/jpeg',\r\n        path: 'image.jpg',\r\n        modifiedDate: '2025-09-21T14:45:00Z'\r\n      }\r\n    ];\r\n  }\r\n}"],"names":["EnhancedBaseComponent","container","inputs","startTime","eventBus","error","previousInputs","updateTime","phase","componentError","remove","timer","observer","element","type","listener","options","callback","delay","newInputs","prevKeys","newKeys","key","ComponentStyleManager","componentId","styles","scoped","namespace","minify","scopeId","processedCSS","template","values","result","i","parsedStyles","componentStyles","name","className","themeVariables","mergedVariables","styleElement","newStyles","hash","char","css","style","selector","globalStyle","s","properties","props","value","variables","htmlElement","rule","prop","str","match","_","letter","styleManager","StyledComponent","styleOptions","createStyles","colors","spacing","typography","FileExplorerComponent","serviceContainer","SERVICE_TOKENS","testClass","styleElements","el","visibleFiles","file","index","isSelected","f","icon","size","date","addressBar","e","searchBox","fileListContainer","menu","path","parentPath","normalizedPath","isAuthenticated","filtered","query","a","b","comparison","dateA","dateB","input","target","files","backBtn","forwardBtn","upBtn","canBack","canForward","canUp","debugPanel","fileItem","filePath","mouseEvent","dragEvent","data","draggedFiles","targetPath","fileToRename","bytes","k","sizes","func","timeoutId","args","mode","x","y","selectedCount","menuItems","item","newName","token","formData","response","errorText","isDirectory","headers","deletePromises","failed","r","url","message","errorDiv","resolve"],"mappings":"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"}