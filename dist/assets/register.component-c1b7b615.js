import{B as y,s as p,S as m,e as u}from"./main-888e55a8.js";class v extends y{authService;windowManager;formData={username:"",email:"",firstName:"",lastName:"",password:"",confirmPassword:"",tier:"Basic",acceptTerms:!1};isLoading=!1;errorMessage=null;fieldErrors={};passwordMinLength=8;usernameMinLength=3;async mount(){console.log("Mounting Register component..."),this.authService=p.get(m.AUTH_SERVICE),this.windowManager=p.get(m.WINDOW_MANAGER),this.buildRegistrationForm(),this.setupEventListeners(),this._mounted=!0,console.log("Register component mounted")}buildRegistrationForm(){this.container.innerHTML="",this.container.className="window-register-container",this.createHeader(),this.createForm()}createHeader(){const e=this.createElement("div",{class:"register-header"}),s=this.createElement("h2",{},"Create Your Account"),t=this.createElement("p",{},"Join VFS Desktop to manage your files in the cloud");e.appendChild(s),e.appendChild(t),this.container.appendChild(e)}createForm(){const e=this.createElement("form",{class:"register-form"}),s=this.createElement("div",{class:"error-message",style:"display: none;"});e.appendChild(s);const t=this.createSection("Personal Information"),r=this.createFormGroup("firstName","First Name","text","Enter your first name",this.formData.firstName,!0);t.appendChild(r);const i=this.createFormGroup("lastName","Last Name","text","Enter your last name",this.formData.lastName,!0);t.appendChild(i),e.appendChild(t);const a=this.createSection("Account Information"),n=this.createFormGroup("username","Username","text","Choose a unique username",this.formData.username,!0);a.appendChild(n);const c=this.createFormGroup("email","Email Address","email","Enter your email address",this.formData.email,!0);a.appendChild(c),e.appendChild(a);const o=this.createSection("Security"),l=this.createFormGroup("password","Password","password",`Enter a strong password (min ${this.passwordMinLength} characters)`,this.formData.password,!0);o.appendChild(l);const d=this.createFormGroup("confirmPassword","Confirm Password","password","Re-enter your password",this.formData.confirmPassword,!0);o.appendChild(d),e.appendChild(o);const h=this.createSection("Account Tier"),f=this.createTierSelection();h.appendChild(f),e.appendChild(h);const g=this.createCheckboxGroup("acceptTerms","I agree to the Terms of Service and Privacy Policy",this.formData.acceptTerms,!0);e.appendChild(g);const E=this.createFormActions();e.appendChild(E),this.addEventListener(e,"submit",w=>{w.preventDefault(),this.handleRegister()}),this.container.appendChild(e)}createSection(e){const s=this.createElement("div",{class:"form-section"}),t=this.createElement("h3",{class:"section-title"},e);return s.appendChild(t),s}createFormGroup(e,s,t,r,i,a=!1){const n=this.createElement("div",{class:"form-group"}),c=this.createElement("label",{for:e});if(c.textContent=s,a){const d=this.createElement("span",{class:"required"}," *");c.appendChild(d)}const o=this.createElement("input",{type:t,id:e,name:e,placeholder:r,value:i,...a?{required:"required"}:{},autocomplete:this.getAutocomplete(e)}),l=this.createElement("div",{class:"field-error",style:"display: none;"});return this.addEventListener(o,"input",()=>{this.formData[e]=o.value,this.validateField(e,o.value)}),this.addEventListener(o,"blur",()=>{this.validateField(e,o.value)}),n.appendChild(c),n.appendChild(o),n.appendChild(l),n}createTierSelection(){const e=this.createElement("div",{class:"form-group tier-selection"});return[{value:"Basic",label:"Basic",description:"Free tier with basic features"},{value:"Standard",label:"Standard",description:"Enhanced features and more storage"},{value:"Premium",label:"Premium",description:"Full access to all features"}].forEach((t,r)=>{const i=this.createElement("div",{class:"tier-option"}),a=this.createElement("input",{type:"radio",id:`tier-${t.value}`,name:"tier",value:t.value,...r===0?{checked:"checked"}:{}}),n=this.createElement("label",{for:`tier-${t.value}`}),c=this.createElement("span",{class:"tier-title"},t.label),o=this.createElement("span",{class:"tier-description"},t.description);n.appendChild(c),n.appendChild(o),this.addEventListener(a,"change",()=>{a.checked&&(this.formData.tier=t.value)}),i.appendChild(a),i.appendChild(n),e.appendChild(i)}),e}createCheckboxGroup(e,s,t,r=!1){const i=this.createElement("div",{class:"form-group checkbox"}),a=this.createElement("input",{type:"checkbox",id:e,name:e,...t?{checked:"checked"}:{},...r?{required:"required"}:{}}),n=this.createElement("label",{for:e});if(n.innerHTML=s,r){const o=this.createElement("span",{class:"required"}," *");n.appendChild(o)}const c=this.createElement("div",{class:"field-error",style:"display: none;"});return this.addEventListener(a,"change",()=>{this.formData[e]=a.checked,r&&this.validateField(e,a.checked.toString())}),i.appendChild(a),i.appendChild(n),i.appendChild(c),i}createFormActions(){const e=this.createElement("div",{class:"form-actions"}),s=this.createElement("button",{type:"submit",class:"btn btn-primary",id:"register-btn"}),t=this.createElement("span",{},"Create Account");s.appendChild(t);const r=this.createElement("button",{type:"button",class:"btn btn-link"},"Already have an account? Sign in");return this.addEventListener(r,"click",()=>this.goToLogin()),e.appendChild(s),e.appendChild(r),e}getAutocomplete(e){return{username:"username",email:"email",firstName:"given-name",lastName:"family-name",password:"new-password",confirmPassword:"new-password"}[e]||"off"}setupEventListeners(){u.on("auth:register",()=>this.handleRegisterSuccess())}validateField(e,s){let t=!0,r="";switch(e){case"username":s.trim()?s.length<this.usernameMinLength?(r=`Username must be at least ${this.usernameMinLength} characters`,t=!1):/^[a-zA-Z0-9_-]+$/.test(s)||(r="Username can only contain letters, numbers, hyphens, and underscores",t=!1):(r="Username is required",t=!1);break;case"email":s.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)||(r="Please enter a valid email address",t=!1):(r="Email address is required",t=!1);break;case"firstName":case"lastName":s.trim()||(r=`${e==="firstName"?"First":"Last"} name is required`,t=!1);break;case"password":s?s.length<this.passwordMinLength?(r=`Password must be at least ${this.passwordMinLength} characters`,t=!1):/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(s)||(r="Password must contain at least one uppercase letter, one lowercase letter, and one number",t=!1):(r="Password is required",t=!1),this.formData.confirmPassword&&this.validateField("confirmPassword",this.formData.confirmPassword);break;case"confirmPassword":s?s!==this.formData.password&&(r="Passwords do not match",t=!1):(r="Please confirm your password",t=!1);break;case"acceptTerms":s!=="true"&&(r="You must accept the terms and conditions",t=!1);break}return this.showFieldError(e,t?null:r),t?delete this.fieldErrors[e]:this.fieldErrors[e]=r,t}showFieldError(e,s){const t=this.container.querySelector(`#${e}`)?.closest(".form-group"),r=t?.querySelector(".field-error");r&&(s?(r.textContent=s,r.style.display="block",t?.classList.add("has-error")):(r.style.display="none",t?.classList.remove("has-error")))}validateForm(){let e=!0;return Object.keys(this.formData).forEach(s=>{const t=s,r=this.formData[t];this.validateField(t,r.toString())||(e=!1)}),e}async handleRegister(){if(!this.validateForm()){this.showError("Please correct the errors above");return}this.setLoading(!0),this.clearError();try{const e=await this.authService.register(this.formData.username.trim(),this.formData.password,this.formData.email.trim());console.log("Registration successful:",e.username)}catch(e){console.error("Registration failed:",e),this.showError(e instanceof Error?e.message:"Registration failed. Please try again.")}finally{this.setLoading(!1)}}async handleRegisterSuccess(){try{this.showNotification("Registration Successful",`Welcome to VFS Desktop, ${this.formData.firstName}!`),await new Promise(e=>setTimeout(e,100)),this.windowManager.closeWindow("register"),setTimeout(()=>{this.openFileExplorer()},200)}catch(e){console.error("Error handling registration success:",e)}}async goToLogin(){try{await this.windowManager.createWindow("login",{title:"Login",size:{width:400,height:350},position:{x:150,y:100}}),this.windowManager.closeWindow("register")}catch(e){console.error("Error opening login window:",e)}}async openFileExplorer(){try{await this.windowManager.createWindow("file-explorer",{title:"File Explorer",size:{width:800,height:600},position:{x:200,y:100}})}catch(e){console.error("Error opening file explorer:",e)}}showError(e){this.errorMessage=e;const s=this.container.querySelector(".error-message");s&&(s.textContent=e,s.style.display="block")}clearError(){this.errorMessage=null;const e=this.container.querySelector(".error-message");e&&(e.style.display="none")}setLoading(e){this.isLoading=e;const s=this.container.querySelector("#register-btn"),t=this.container.querySelector("form");s&&t&&(s.disabled=e,e?s.innerHTML=`
          <span class="spinner"></span>
          <span>Creating Account...</span>
        `:s.innerHTML="<span>Create Account</span>",t.querySelectorAll("input, button").forEach(i=>{i.disabled=e}))}showNotification(e,s){console.log(`${e}: ${s}`)}async unmount(){u.off("auth:register",this.handleRegisterSuccess),await this.baseUnmount(),console.log("Register component unmounted")}}export{v as RegisterComponent};
//# sourceMappingURL=register.component-c1b7b615.js.map
